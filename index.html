<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>network // home</title>
    <script>
        // --- AUTHENTICATION CHECK ---
        // If no user is logged in, redirect immediately to login.html
        const currentUser = localStorage.getItem('username');
        if (!currentUser) {
            window.location.href = 'login.html';
        }
    </script>
    <style>
        /* --- RESET & BASE STYLES --- */
        * { box-sizing: border-box; margin: 0; padding: 0; }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #050a10; }
        ::-webkit-scrollbar-thumb { background: #365863; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #5588aa; }

        body {
            background-color: #020508;
            /* Dark misty background */
            background-image: 
                radial-gradient(circle at 50% 50%, rgba(20, 60, 70, 0.4) 0%, rgba(0,0,0,0) 70%),
                repeating-linear-gradient(0deg, transparent 0px, transparent 1px, rgba(0, 255, 255, 0.03) 2px, transparent 3px);
            background-size: cover;
            font-family: 'Courier New', Courier, monospace;
            color: #aaddff;
            height: 100vh;
            width: 100vw;
            overflow: hidden; /* No Body Scroll */
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* --- CRT EFFECT --- */
        .scanlines {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
            background-size: 100% 2px, 3px 100%;
            pointer-events: none; z-index: 10;
        }

        /* --- MAIN CONTAINER --- */
        .main-interface {
            width: 950px;
            height: 600px;
            max-width: 98vw;
            max-height: 98vh;
            background: rgba(4, 15, 20, 0.75);
            border: 1px solid #365863;
            box-shadow: 0 0 25px rgba(0, 255, 255, 0.1), inset 0 0 50px rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            border-radius: 8px;
            display: grid;
            grid-template-rows: 50px 1fr 30px;
            position: relative;
        }

        /* --- DECOR --- */
        .star { position: absolute; color: #5588aa; text-shadow: 0 0 5px #aaddff; pointer-events: none; z-index: 2; }
        .s1 { top: -15px; left: -10px; transform: rotate(-15deg); font-size: 24px; }
        .s2 { bottom: -20px; right: 20px; transform: rotate(15deg); font-size: 30px; }

        /* --- HEADER --- */
        header {
            border-bottom: 1px solid #365863;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            background: rgba(0,0,0,0.3);
        }
        .logo { font-size: 1.5rem; font-weight: bold; letter-spacing: -1px; text-shadow: 0 0 8px rgba(100, 200, 255, 0.6); color: #fff; }
        .logout-btn { background: none; border: 1px solid #365863; color: #588090; padding: 2px 8px; cursor: pointer; font-family: inherit; font-size: 0.8rem; }
        .logout-btn:hover { color: #ff5555; border-color: #ff5555; box-shadow: 0 0 5px #ff5555; }

        /* --- CONTENT GRID --- */
        .content-area {
            display: grid;
            grid-template-columns: 200px 1fr 220px; /* Sidebar | Feed | Chat */
            gap: 15px;
            padding: 15px;
            overflow: hidden;
        }

        .panel {
            background: rgba(0, 0, 0, 0.4);
            border: 1px dashed #365863;
            padding: 10px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
        }

        h2 {
            font-size: 0.8rem; background: #122228; color: #aaddff;
            padding: 2px 5px; margin-bottom: 10px; border-left: 3px solid #aaddff;
            text-transform: uppercase;
        }

        /* --- LEFT: PROFILE & FRIENDS --- */
        .profile-card {
            text-align: center; margin-bottom: 15px; border-bottom: 1px solid #365863; padding-bottom: 10px;
        }
        .pfp-box {
            width: 60px; height: 60px; background: #000; border: 1px solid #fff;
            margin: 0 auto 5px auto; display: flex; align-items: center; justify-content: center; font-size: 0.7rem; color: #555;
        }
        .friend-list { list-style: none; overflow-y: auto; flex-grow: 1; }
        .friend-item {
            display: flex; align-items: center; gap: 8px; padding: 4px 0; font-size: 0.8rem; cursor: pointer;
        }
        .friend-item:hover { color: #fff; }
        .status-dot { width: 6px; height: 6px; background: #333; border-radius: 50%; }
        .status-dot.online { background: #00ffaa; box-shadow: 0 0 4px #00ffaa; }

        /* --- MIDDLE: FEED --- */
        .post-input-area {
            margin-bottom: 15px; border-bottom: 1px solid #365863; padding-bottom: 10px;
        }
        .status-input {
            width: 100%; background: #050a10; border: 1px solid #365863; color: #aaddff;
            padding: 8px; font-family: inherit; font-size: 0.85rem; resize: none; height: 50px;
        }
        .post-btn {
            float: right; margin-top: 5px; background: #234; border: 1px solid #aaddff;
            color: #aaddff; padding: 2px 10px; cursor: pointer; font-family: inherit; font-size: 0.75rem;
        }
        .post-btn:hover { background: #aaddff; color: #000; }

        .feed-container { overflow-y: auto; flex-grow: 1; padding-right: 5px; }
        .post {
            margin-bottom: 15px; border: 1px solid #223344; background: rgba(0,0,0,0.2); padding: 8px;
        }
        .post-header { display: flex; justify-content: space-between; font-size: 0.7rem; color: #5588aa; margin-bottom: 5px; border-bottom: 1px dotted #334455; padding-bottom: 2px;}
        .post-content { font-size: 0.85rem; line-height: 1.3; color: #cee; margin-bottom: 8px;}
        .post-actions { display: flex; gap: 10px; font-size: 0.7rem; }
        .action-btn { color: #446677; cursor: pointer; text-decoration: none; border: none; background: none; font-family: inherit; padding: 0;}
        .action-btn:hover { color: #fff; text-shadow: 0 0 3px #fff; }
        .block-btn:hover { color: #ff5555; text-shadow: 0 0 3px #ff5555; }

        /* --- RIGHT: CHAT --- */
        .chat-history {
            flex-grow: 1; overflow-y: auto; margin-bottom: 10px; border: 1px solid #223344; background: rgba(0,0,0,0.3); padding: 5px; font-size: 0.75rem;
        }
        .chat-msg { margin-bottom: 4px; }
        .chat-user { color: #ff00ff; font-weight: bold; }
        .chat-text { color: #ccc; }
        .chat-input {
            width: 100%; background: #050a10; border: 1px solid #365863; color: white; padding: 4px; font-family: inherit; font-size: 0.75rem;
        }

        /* --- FOOTER --- */
        footer { border-top: 1px solid #365863; display: flex; align-items: center; justify-content: center; font-size: 0.7rem; color: #365863; }

        /* --- MOBILE --- */
        @media (max-width: 800px) {
            .content-area { grid-template-columns: 1fr; overflow-y: auto; }
            .main-interface { height: 100vh; width: 100vw; border: none; }
            .panel { min-height: 200px; margin-bottom: 10px; }
        }
    </style>
</head>
<body>

    <div class="scanlines"></div>

    <div class="main-interface">
        <div class="star s1">★</div>
        <div class="star s2">✦</div>

        <header>
            <div class="logo">network</div>
            <div>
                <span id="display-user" style="margin-right: 15px; font-size: 0.8rem; color: #00ffaa;">loading...</span>
                <button class="logout-btn" onclick="logout()">[ logout ]</button>
            </div>
        </header>

        <div class="content-area">
            <div class="panel">
                <div class="profile-card">
                    <div class="pfp-box"><img src="" alt="img" style="display:none;">[ no img ]</div>
                    <div style="font-size: 0.8rem; color: #fff;">Status: Online</div>
                </div>
                
                <h2>Friends</h2>
                <ul class="friend-list">
                    <li class="friend-item"><span class="status-dot online"></span> jinks</li>
                    <li class="friend-item"><span class="status-dot online"></span> bladee_fan</li>
                    <li class="friend-item"><span class="status-dot"></span> vampire_goth</li>
                    <li class="friend-item"><span class="status-dot online"></span> webmaster</li>
                    <li class="friend-item"><span class="status-dot"></span> guest_99</li>
                </ul>
            </div>

            <div class="panel">
                <h2>Stream</h2>
                
                <div class="post-input-area">
                    <textarea class="status-input" id="postText" placeholder="What is on your mind?"></textarea>
                    <button class="post-btn" onclick="createPost()">POST</button>
                    <div style="clear:both;"></div>
                </div>

                <div class="feed-container" id="feed">
                    <div class="post">
                        <div class="post-header">
                            <span>system</span>
                            <span>Today // 08:00</span>
                        </div>
                        <div class="post-content">
                            Welcome to the network. Please be nice.
                        </div>
                        <div class="post-actions">
                            <button class="action-btn">[ reply ]</button>
                            <button class="action-btn block-btn">[ block ]</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="panel">
                <h2>Global Chat</h2>
                <div class="chat-history" id="chatBox">
                    <div class="chat-msg">
                        <span class="chat-user">&lt;system&gt;</span> 
                        <span class="chat-text">Connection established...</span>
                    </div>
                </div>
                <input type="text" class="chat-input" id="chatInput" placeholder="Say something..." onkeypress="handleChat(event)">
            </div>
        </div>

        <footer>
            &copy; 2025 network inc.
        </footer>
    </div>

    <script>
        // --- LOGIC ---
        
        // 1. Load User Info
        const username = localStorage.getItem('username') || 'Guest';
        document.getElementById('display-user').textContent = `user: ${username}`;

        // 2. Logout Function
        function logout() {
            localStorage.removeItem('username');
            window.location.href = 'login.html';
        }

        // 3. Post Creation (Mock for now)
        function createPost() {
            const text = document.getElementById('postText').value;
            if(!text) return;

            // TODO: FIREBASE - Push this data to Firestore 'posts' collection
            
            const feed = document.getElementById('feed');
            const newPost = document.createElement('div');
            newPost.className = 'post';
            
            const time = new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
            
            newPost.innerHTML = `
                <div class="post-header">
                    <span>${username}</span>
                    <span>Today // ${time}</span>
                </div>
                <div class="post-content">${text}</div>
                <div class="post-actions">
                    <button class="action-btn" onclick="replyToPost(this)">[ reply ]</button>
                    <button class="action-btn block-btn" onclick="blockUser('${username}')">[ block ]</button>
                </div>
            `;
            
            // Insert at top
            feed.insertBefore(newPost, feed.firstChild);
            document.getElementById('postText').value = '';
        }

        // 4. Chat Function (Mock for now)
        function handleChat(e) {
            if(e.key === 'Enter') {
                const input = document.getElementById('chatInput');
                const msg = input.value;
                if(!msg) return;

                // TODO: FIREBASE - Push this to Realtime Database 'chat' node

                const chatBox = document.getElementById('chatBox');
                const newMsg = document.createElement('div');
                newMsg.className = 'chat-msg';
                newMsg.innerHTML = `<span class="chat-user">&lt;${username}&gt;</span> <span class="chat-text">${msg}</span>`;
                
                chatBox.appendChild(newMsg);
                chatBox.scrollTop = chatBox.scrollHeight; // Auto scroll to bottom
                input.value = '';
            }
        }

        function replyToPost(btn) {
            const input = document.getElementById('postText');
            input.focus();
            input.placeholder = "Replying...";
        }

        function blockUser(user) {
            alert(`Blocked content from ${user}`);
            // TODO: Add logic to hide posts from this user ID
        }

    </script>
</body>
</html>